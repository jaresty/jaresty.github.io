<!DOCTYPE html>
<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ruby Critic - Home</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- StyleSheets -->
    <link href="../../assets/stylesheets/bootstrap.min.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="../../assets/stylesheets/font-awesome.min.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="../../assets/stylesheets/prettify.custom_theme.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="../../assets/stylesheets/application.css" media="screen, projection, print" rel="stylesheet" type="text/css">
  </head>

  <body>
    <header class="navbar navbar-default navbar-fixed-top">
      <a href="#menu-toggle" class="btn btn-default hidden-lg visible-sm-* hidden-md visible-xs-* pull-left" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a>
      <a href="../../overview.html"><img src="../../assets/images/logo.png" title="Ruby Critic Logo" width="55"><span class="logo">RUBYCRITIC</span></a>
    </header>
    <div id="wrapper">
      <!-- Sidebar -->
      <aside id="sidebar-wrapper">
        <ul class="sidebar-nav">
          <li class="sidebar-item">
            <a href="../../overview.html" class="project-nav-item overview-nav"><i class="fa fa-dashboard"></i>Overview</a>
          </li>
          <li class="sidebar-item">
            <a href="../../code_index.html" class="project-nav-item code-index-nav"><i class="fa fa-code"></i>Code</a>
          </li>
          <li class="sidebar-item">
            <a href="../../smells_index.html" class="project-nav-item smells-index-nav"><i class="fa fa-warning"></i>Smells</a>
          </li>
        </ul>
      </aside>
      <!-- /#sidebar-wrapper -->
      <div id="page-content-wrapper">
        <div class="container-fluid">
          <div class="row">
  <!--Page Title -->
  <div class="Page_Title">
    <div class="file-time">
      <span class="committed-at">
        
          Updated <time class='js-timeago' datetime='2018-04-12 11:56:46 -0700'>2018-04-12 11:56:46 -0700</time>
        
      </span>
    </div>
    <div>
      <h3><small>spec/support /</small> director.rb</h3>
    </div>
  </div>
  <!--End Page Title -->
  <div class="Content_Wrapper">
    <!-- code detail -->
    <div class="code-top-detail clearfix row">
      <div class="col-md-8">
        <div class="row">
          <div class="col-md-1">
            <div class="rating d big">
              D
            </div>
          </div>
          <div class="code-statistics col-md-11">
            <div class="col-md-3">
              <div><span class="metric">241</span><small> lines of codes</small></div>
              <div><span class="metric">24</span><small> methods</small></div>
            </div>
            <div class="col-md-3">
              <div><span class="metric">8.7</span><small> complexity/method</small></div>
              <div><span class="metric">59</span><small> churn</small></div>
            </div>
            <div class="col-md-3">
              <div><span class="metric">207.62</span><small> complexity</small></div>
              <div><span class="metric">19</span><small> duplications</small></div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="code-tabs">
          <ul class="nav nav-pills right-to-left">
            <li><a href="#" id="toggle-code" class="toggle-button button">code</a></li>
            <li class="active">
              <a href="#" id="toggle-smells" class="toggle-button button">
                33
                smells
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <code class="prettyprint linenums lang-ruby file-code js-file-code">module Bosh::Spec<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Irresponsible-Module.md" target="_blank"><b>IrresponsibleModule</b></a>        </span>      </div>      <span>Bosh::Spec has no descriptive comment</span>          </div>  </li></ol>
  # Director information as a regular CLI user would see it.
  # State might not be necessarily in sync with what CPI thinks
  # (e.g. CPI might know about more VMs that director does).
  require_relative &#39;../shared/support/table_helpers&#39;

  class Director<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Instance-Variable-Assumption.md" target="_blank"><b>InstanceVariableAssumption</b></a>        </span>      </div>      <span>Bosh::Spec::Director assumes too much for instance variable '@nats_client'</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Irresponsible-Module.md" target="_blank"><b>IrresponsibleModule</b></a>        </span>      </div>      <span>Bosh::Spec::Director has no descriptive comment</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Instance-Variables.md" target="_blank"><b>TooManyInstanceVariables</b></a>        </span>      </div>      <span>Bosh::Spec::Director has at least 8 instance variables</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Methods.md" target="_blank"><b>TooManyMethods</b></a>        </span>      </div>      <span>Bosh::Spec::Director has at least 24 methods</span>          </div>  </li></ol>
    include Support::TableHelpers
    def initialize(runner, waiter, agents_base_dir, db, director_nats_config, logger)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Long-Parameter-List.md" target="_blank"><b>LongParameterList</b></a>        </span>      </div>      <span>Bosh::Spec::Director#initialize has 6 parameters</span>          </div>  </li></ol>
      @runner = runner
      @waiter = waiter
      @agents_base_dir = agents_base_dir
      @db = db
      @logger = logger
      @nats_recording = []
      @director_nats_config = director_nats_config
    end

    def instances(options={deployment_name: Deployments::DEFAULT_DEPLOYMENT_NAME})
      instances_details(options).map do |instance_data|
        Bosh::Spec::Instance.new(
          @waiter,
          instance_data[:process_state],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:vm_cid],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:agent_id],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances calls 'instance_data[:agent_id]' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L25" class="js-smell-location">0</a>                  <a href="director.html#L35" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:resurrection],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:ips],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:az],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:id],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:job_name],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:index],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:ignore],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:bootstrap] == &#39;true&#39;,<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          instance_data[:disk_cids],<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          File.join(@agents_base_dir, &quot;agent-base-dir-#{instance_data[:agent_id]}&quot;),<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances calls 'instance_data[:agent_id]' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L25" class="js-smell-location">0</a>                  <a href="director.html#L35" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#instances refers to 'instance_data' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L23" class="js-smell-location">0</a>                  <a href="director.html#L24" class="js-smell-location">1</a>                  <a href="director.html#L25" class="js-smell-location">2</a>                  <a href="director.html#L26" class="js-smell-location">3</a>                  <a href="director.html#L27" class="js-smell-location">4</a>                  <a href="director.html#L28" class="js-smell-location">5</a>                  <a href="director.html#L29" class="js-smell-location">6</a>                  <a href="director.html#L30" class="js-smell-location">7</a>                  <a href="director.html#L31" class="js-smell-location">8</a>                  <a href="director.html#L32" class="js-smell-location">9</a>                  <a href="director.html#L33" class="js-smell-location">10</a>                  <a href="director.html#L34" class="js-smell-location">11</a>                  <a href="director.html#L35" class="js-smell-location">12</a>                  </div>  </li></ol>
          @director_nats_config,
          @logger,
        )
      end
    end

    def vms(options={})
      parse_table_with_ips(@runner.run(&#39;vms&#39;, options.merge(json: true))).map do |vm_data|
        Bosh::Spec::Vm.new(
          @waiter,
          vm_data[:process_state],
          vm_data[:vm_cid],
          vm_data[:ips],
          vm_data[:az],
          vm_data[:id],
          vm_data[:job_name],
          @director_nats_config,
          @logger,
          File.join(@agents_base_dir, &quot;agent-base-dir-*&quot;),
        )
      end
    end

    # vm always returns a vm
    def instance(job_name, index_or_id, options={deployment_name: Deployments::DEFAULT_DEPLOYMENT_NAME})
      find_instance(instances(options), job_name, index_or_id)
    end

    def find_instance(instances, instance_group_name, index_or_id)
      instance = instances.detect { |instance| instance.instance_group_name == instance_group_name &amp;&amp; (instance.index == index_or_id || instance.id == index_or_id)}<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#find_instance refers to 'instance' more than self (maybe move it to another class?)</span>          </div>  </li></ol>
      instance || raise(&quot;Failed to find instance #{instance_group_name}/#{index_or_id}. Found instances: #{instances.inspect}&quot;)
    end

    # wait_for_vm either returns a vm or nil after waiting for X seconds
    # (Do not add default timeout value to be more explicit in tests)
    def wait_for_vm(instance_group_name, index, timeout_seconds, options = {deployment_name: Deployments::DEFAULT_DEPLOYMENT_NAME})<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="http://docs.seattlerb.org/flog/" target="_blank"><b>HighComplexity</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm has a flog score of 32</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Long-Parameter-List.md" target="_blank"><b>LongParameterList</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm has 4 parameters</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm has approx 9 statements</span>          </div>  </li></ol>
      start_time = Time.now<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm calls 'Time.now' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L72" class="js-smell-location">0</a>                  <a href="director.html#L76" class="js-smell-location">1</a>                  </div>  </li></ol>
      loop do
        vm = instances(options).detect { |vm| !vm.vm_cid.empty? &amp;&amp; vm.instance_group_name == instance_group_name &amp;&amp; vm.index == index &amp;&amp; vm.last_known_state != &#39;unresponsive agent&#39; &amp;&amp; vm.last_known_state != nil }<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Control-Parameter.md" target="_blank"><b>ControlParameter</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm is controlled by argument 'index'</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Control-Parameter.md" target="_blank"><b>ControlParameter</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm is controlled by argument 'instance_group_name'</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm calls 'vm.last_known_state' 2 times</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm refers to 'vm' more than self (maybe move it to another class?)</span>          </div>  </li></ol>
        return vm if vm
        break if Time.now - start_time &gt;= timeout_seconds<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_vm calls 'Time.now' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L72" class="js-smell-location">0</a>                  <a href="director.html#L76" class="js-smell-location">1</a>                  </div>  </li></ol>
        sleep(1)
      end

      @logger.info(&quot;Did not find VM after waiting for #{timeout_seconds}&quot;)
      nil
    end

    def wait_for_first_available_instance(timeout = 60, options = {deployment_name: Deployments::DEFAULT_DEPLOYMENT_NAME})
      @waiter.wait(timeout) { instances(options).first || raise(&#39;Must have at least 1 VM&#39;) }
    end

    def wait_for_first_available_vm(timeout = 60)
      @waiter.wait(timeout) { vms.first || raise(&#39;Must have at least 1 VM&#39;) }
    end

    def vms_vitals
      options = add_defaults({})
      parse_table_with_ips(@runner.run(&#39;vms --vitals&#39;, options))
    end

    def vms_cloud_properties
      parse_table(@runner.run(&#39;vms --cloud-properties&#39;, { json: true }))
    end

    def instances_vitals(options = {})
      options = add_defaults(options)
      parse_table(@runner.run(&#39;instances --vitals&#39;, options))
    end

    def instances_ps(options = {})
      options = add_defaults(options)
      parse_table(@runner.run(&#39;instances --ps&#39;, options))
    end

    def instances_ps_vitals(options = {})
      options = add_defaults(options)
      parse_table(@runner.run(&#39;instances --ps --vitals&#39;, options))
    end

    def instances_ps_vitals_failing(options = {})
      options = add_defaults(options)
      parse_table(@runner.run(&#39;instances --ps --vitals --failing&#39;, options))
    end

    def start_recording_nats
      Thread.new do
        EventMachine.run do
          @nats_client = NATS.connect(@director_nats_config) do
            @nats_client.subscribe(&#39;&gt;&#39;) do |msg, reply, sub|
              @nats_recording &lt;&lt; [sub, msg]
            end
          end
        end
      end
    end

    def finish_recording_nats
      @nats_client.close
      EventMachine.stop
      @nats_recording
    end

    def task(id)
      output = @runner.run(&quot;task #{id}&quot;, failure_expected: true) # permit failures, gocli task command fails if non-success. ruby cli return success despite task failure.
      failed = /Task (\d+) error/.match(output)
      return output, !failed
    end

    def raw_task_events(task_id)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::Director#raw_task_events has approx 6 statements</span>          </div>  </li></ol>
      result = @runner.run(&quot;task #{task_id} --raw&quot;)
      event_list = []
      result.each_line do |line|<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="http://docs.seattlerb.org/flay/" target="_blank"><b>DuplicateCode</b></a>        </span>      </div>      <span>Identical code found in 2 nodes</span>              <span>Locations:</span>                  <a href="../gocli/integration/deploy_job_update_spec.html#L179" class="js-smell-location">0</a>                  <a href="director.html#L148" class="js-smell-location">1</a>                  </div>  </li></ol>
        begin
          event = JSON.parse(line)
          event_list &lt;&lt; event if event
        rescue JSON::ParserError
        end
      end
      event_list
    end

    def kill_vm_and_wait_for_resurrection(vm, options={deployment_name: Deployments::DEFAULT_DEPLOYMENT_NAME})<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection has approx 6 statements</span>          </div>  </li></ol>
      vm.kill_agent<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection refers to 'vm' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L159" class="js-smell-location">0</a>                  <a href="director.html#L161" class="js-smell-location">1</a>                  <a href="director.html#L165" class="js-smell-location">2</a>                  <a href="director.html#L167" class="js-smell-location">3</a>                  <a href="director.html#L168" class="js-smell-location">4</a>                  </div>  </li></ol>

      wait_for_vm(vm.instance_group_name, vm.index, 300, options)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection calls 'vm.index' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L161" class="js-smell-location">0</a>                  <a href="director.html#L165" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection calls 'vm.instance_group_name' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L161" class="js-smell-location">0</a>                  <a href="director.html#L165" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection calls 'wait_for_vm(vm.instance_group_name, vm.index, 300, options)' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L161" class="js-smell-location">0</a>                  <a href="director.html#L165" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection refers to 'vm' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L159" class="js-smell-location">0</a>                  <a href="director.html#L161" class="js-smell-location">1</a>                  <a href="director.html#L165" class="js-smell-location">2</a>                  <a href="director.html#L167" class="js-smell-location">3</a>                  <a href="director.html#L168" class="js-smell-location">4</a>                  </div>  </li></ol>

      wait_for_resurrection_to_finish

      resurrected_vm = wait_for_vm(vm.instance_group_name, vm.index, 300, options)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection calls 'vm.index' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L161" class="js-smell-location">0</a>                  <a href="director.html#L165" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection calls 'vm.instance_group_name' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L161" class="js-smell-location">0</a>                  <a href="director.html#L165" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection calls 'wait_for_vm(vm.instance_group_name, vm.index, 300, options)' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L161" class="js-smell-location">0</a>                  <a href="director.html#L165" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection refers to 'vm' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L159" class="js-smell-location">0</a>                  <a href="director.html#L161" class="js-smell-location">1</a>                  <a href="director.html#L165" class="js-smell-location">2</a>                  <a href="director.html#L167" class="js-smell-location">3</a>                  <a href="director.html#L168" class="js-smell-location">4</a>                  </div>  </li></ol>

      if vm.vm_cid == resurrected_vm.vm_cid<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection refers to 'vm' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L159" class="js-smell-location">0</a>                  <a href="director.html#L161" class="js-smell-location">1</a>                  <a href="director.html#L165" class="js-smell-location">2</a>                  <a href="director.html#L167" class="js-smell-location">3</a>                  <a href="director.html#L168" class="js-smell-location">4</a>                  </div>  </li></ol>
        raise &quot;expected vm to be recreated by cids match. original: #{vm.inspect}, new: #{resurrected_vm.inspect}&quot;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#kill_vm_and_wait_for_resurrection refers to 'vm' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L159" class="js-smell-location">0</a>                  <a href="director.html#L161" class="js-smell-location">1</a>                  <a href="director.html#L165" class="js-smell-location">2</a>                  <a href="director.html#L167" class="js-smell-location">3</a>                  <a href="director.html#L168" class="js-smell-location">4</a>                  </div>  </li></ol>
      end

      resurrected_vm
    end

    def wait_for_resurrection_to_finish<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::Director#wait_for_resurrection_to_finish has approx 7 statements</span>          </div>  </li></ol>
      attempts = 0

      while attempts &lt; 20
        attempts += 1
        resurrection_task = @db[:tasks].filter(
          username: &#39;hm&#39;,
          description: &#39;scan and fix&#39;,
          state: &#39;processing&#39;
        )
        return unless resurrection_task.any?

        @logger.debug(&quot;Waiting for resurrection to finish, found resurrection tasks: #{resurrection_task.all}&quot;)
        sleep(0.5)
      end

      @logger.debug(&#39;Failed to wait for resurrection to complete&#39;)
    end

    private

    def add_defaults(options)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Utility-Function.md" target="_blank"><b>UtilityFunction</b></a>        </span>      </div>      <span>Bosh::Spec::Director#add_defaults doesn't depend on instance state (maybe move it to another class?)</span>          </div>  </li></ol>
      options[:json] = true
      options[:deployment_name] ||= Deployments::DEFAULT_DEPLOYMENT_NAME
      options
    end

    def instances_details(options = {})
      parse_table_with_ips(@runner.run(&quot;instances --details&quot;, options.merge(json: true)))
    end

    def parse_table(output)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table has approx 6 statements</span>          </div>  </li></ol>
      parsed_table = table(output)

      parsed_table.map do |row|
        converted_row = row.dup<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table refers to 'row' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L209" class="js-smell-location">0</a>                  <a href="director.html#L211" class="js-smell-location">1</a>                  </div>  </li></ol>

        row.each do |key, value|<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table refers to 'row' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L209" class="js-smell-location">0</a>                  <a href="director.html#L211" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Nested-Iterators.md" target="_blank"><b>NestedIterators</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table contains iterators nested 2 deep</span>          </div>  </li></ol>
          converted_row[key.to_sym] = value
        end

        converted_row
      end
    end

    def parse_table_with_ips(output)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips has approx 12 statements</span>          </div>  </li></ol>
      instances = parse_table(output)

      job_name_match_index = 1
      instance_id_match_index = 2

      instances.map do |instance|
        match_data = /(.*)\/([0-9a-f]{8}-[0-9a-f-]{27})/.match(instance[:instance])<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips refers to 'instance' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L226" class="js-smell-location">0</a>                  <a href="director.html#L228" class="js-smell-location">1</a>                  <a href="director.html#L229" class="js-smell-location">2</a>                  <a href="director.html#L231" class="js-smell-location">3</a>                  <a href="director.html#L232" class="js-smell-location">4</a>                  <a href="director.html#L234" class="js-smell-location">5</a>                  <a href="director.html#L235" class="js-smell-location">6</a>                  </div>  </li></ol>
        if match_data
          instance[:job_name] = match_data[job_name_match_index]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips refers to 'instance' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L226" class="js-smell-location">0</a>                  <a href="director.html#L228" class="js-smell-location">1</a>                  <a href="director.html#L229" class="js-smell-location">2</a>                  <a href="director.html#L231" class="js-smell-location">3</a>                  <a href="director.html#L232" class="js-smell-location">4</a>                  <a href="director.html#L234" class="js-smell-location">5</a>                  <a href="director.html#L235" class="js-smell-location">6</a>                  </div>  </li></ol>
          instance[:id] = match_data[instance_id_match_index]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips refers to 'instance' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L226" class="js-smell-location">0</a>                  <a href="director.html#L228" class="js-smell-location">1</a>                  <a href="director.html#L229" class="js-smell-location">2</a>                  <a href="director.html#L231" class="js-smell-location">3</a>                  <a href="director.html#L232" class="js-smell-location">4</a>                  <a href="director.html#L234" class="js-smell-location">5</a>                  <a href="director.html#L235" class="js-smell-location">6</a>                  </div>  </li></ol>

          instance[:ips] = instance[:ips].split(&quot;\n&quot;)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips calls 'instance[:ips]' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L231" class="js-smell-location">0</a>                  <a href="director.html#L232" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips refers to 'instance' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L226" class="js-smell-location">0</a>                  <a href="director.html#L228" class="js-smell-location">1</a>                  <a href="director.html#L229" class="js-smell-location">2</a>                  <a href="director.html#L231" class="js-smell-location">3</a>                  <a href="director.html#L232" class="js-smell-location">4</a>                  <a href="director.html#L234" class="js-smell-location">5</a>                  <a href="director.html#L235" class="js-smell-location">6</a>                  </div>  </li></ol>
          instance[&#39;IPs&#39;] = instance[:ips]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips calls 'instance[:ips]' 2 times</span>              <span>Locations:</span>                  <a href="director.html#L231" class="js-smell-location">0</a>                  <a href="director.html#L232" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips refers to 'instance' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L226" class="js-smell-location">0</a>                  <a href="director.html#L228" class="js-smell-location">1</a>                  <a href="director.html#L229" class="js-smell-location">2</a>                  <a href="director.html#L231" class="js-smell-location">3</a>                  <a href="director.html#L232" class="js-smell-location">4</a>                  <a href="director.html#L234" class="js-smell-location">5</a>                  <a href="director.html#L235" class="js-smell-location">6</a>                  </div>  </li></ol>

          instance[:disk_cids] = instance[:disk_cids].split(&quot;\n&quot;) if instance[:disk_cids]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips calls 'instance[:disk_cids]' 3 times</span>              <span>Locations:</span>                  <a href="director.html#L234" class="js-smell-location">0</a>                  <a href="director.html#L235" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips refers to 'instance' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L226" class="js-smell-location">0</a>                  <a href="director.html#L228" class="js-smell-location">1</a>                  <a href="director.html#L229" class="js-smell-location">2</a>                  <a href="director.html#L231" class="js-smell-location">3</a>                  <a href="director.html#L232" class="js-smell-location">4</a>                  <a href="director.html#L234" class="js-smell-location">5</a>                  <a href="director.html#L235" class="js-smell-location">6</a>                  </div>  </li></ol>
          instance[&#39;Disk CIDs&#39;] = instance[:disk_cids]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips calls 'instance[:disk_cids]' 3 times</span>              <span>Locations:</span>                  <a href="director.html#L234" class="js-smell-location">0</a>                  <a href="director.html#L235" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::Director#parse_table_with_ips refers to 'instance' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="director.html#L226" class="js-smell-location">0</a>                  <a href="director.html#L228" class="js-smell-location">1</a>                  <a href="director.html#L229" class="js-smell-location">2</a>                  <a href="director.html#L231" class="js-smell-location">3</a>                  <a href="director.html#L232" class="js-smell-location">4</a>                  <a href="director.html#L234" class="js-smell-location">5</a>                  <a href="director.html#L235" class="js-smell-location">6</a>                  </div>  </li></ol>
        end
        instance
      end
    end
  end
end
</code>
  </div>
</div>

        </div>
      </div>
    </div>

    <!-- Javascripts -->
    <script src='../../assets/javascripts/jquery.min.js'></script>
    <script src='../../assets/javascripts/jquery.tablesorter.min.js'></script>
    <script src='../../assets/javascripts/jquery.scrollTo.min.js'></script>
    <script src='../../assets/javascripts/jquery.timeago.js'></script>
    <script src='../../assets/javascripts/highcharts.src-4.0.1.js'></script>
    <script src='../../assets/javascripts/prettify.js'></script>
    <script src='../../assets/javascripts/bootstrap.min.js'></script>
    <script src='../../assets/javascripts/application.js'></script>
    <script src='../../assets/javascripts/jquery.filtertable.min.js'></script>
  </body>
</html>
