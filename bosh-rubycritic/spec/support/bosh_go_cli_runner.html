<!DOCTYPE html>
<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ruby Critic - Home</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- StyleSheets -->
    <link href="../../assets/stylesheets/bootstrap.min.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="../../assets/stylesheets/font-awesome.min.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="../../assets/stylesheets/prettify.custom_theme.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="../../assets/stylesheets/application.css" media="screen, projection, print" rel="stylesheet" type="text/css">
  </head>

  <body>
    <header class="navbar navbar-default navbar-fixed-top">
      <a href="#menu-toggle" class="btn btn-default hidden-lg visible-sm-* hidden-md visible-xs-* pull-left" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a>
      <a href="../../overview.html"><img src="../../assets/images/logo.png" title="Ruby Critic Logo" width="55"><span class="logo">RUBYCRITIC</span></a>
    </header>
    <div id="wrapper">
      <!-- Sidebar -->
      <aside id="sidebar-wrapper">
        <ul class="sidebar-nav">
          <li class="sidebar-item">
            <a href="../../overview.html" class="project-nav-item overview-nav"><i class="fa fa-dashboard"></i>Overview</a>
          </li>
          <li class="sidebar-item">
            <a href="../../code_index.html" class="project-nav-item code-index-nav"><i class="fa fa-code"></i>Code</a>
          </li>
          <li class="sidebar-item">
            <a href="../../smells_index.html" class="project-nav-item smells-index-nav"><i class="fa fa-warning"></i>Smells</a>
          </li>
        </ul>
      </aside>
      <!-- /#sidebar-wrapper -->
      <div id="page-content-wrapper">
        <div class="container-fluid">
          <div class="row">
  <!--Page Title -->
  <div class="Page_Title">
    <div class="file-time">
      <span class="committed-at">
        
          Updated <time class='js-timeago' datetime='2017-10-25 11:45:42 -0700'>2017-10-25 11:45:42 -0700</time>
        
      </span>
    </div>
    <div>
      <h3><small>spec/support /</small> bosh_go_cli_runner.rb</h3>
    </div>
  </div>
  <!--End Page Title -->
  <div class="Content_Wrapper">
    <!-- code detail -->
    <div class="code-top-detail clearfix row">
      <div class="col-md-8">
        <div class="row">
          <div class="col-md-1">
            <div class="rating c big">
              C
            </div>
          </div>
          <div class="code-statistics col-md-11">
            <div class="col-md-3">
              <div><span class="metric">174</span><small> lines of codes</small></div>
              <div><span class="metric">13</span><small> methods</small></div>
            </div>
            <div class="col-md-3">
              <div><span class="metric">11.7</span><small> complexity/method</small></div>
              <div><span class="metric">59</span><small> churn</small></div>
            </div>
            <div class="col-md-3">
              <div><span class="metric">151.98</span><small> complexity</small></div>
              <div><span class="metric">16</span><small> duplications</small></div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="code-tabs">
          <ul class="nav nav-pills right-to-left">
            <li><a href="#" id="toggle-code" class="toggle-button button">code</a></li>
            <li class="active">
              <a href="#" id="toggle-smells" class="toggle-button button">
                17
                smells
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <code class="prettyprint linenums lang-ruby file-code js-file-code">require_relative &#39;../shared/support/table_helpers&#39;

module Bosh::Spec
  class BoshGoCliRunner<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Irresponsible-Module.md" target="_blank"><b>IrresponsibleModule</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner has no descriptive comment</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Instance-Variables.md" target="_blank"><b>TooManyInstanceVariables</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner has at least 7 instance variables</span>          </div>  </li></ol>
    include Support::TableHelpers

    def initialize(bosh_work_dir, bosh_config, agent_log_path_resolver, nats_log_path, saved_logs_path, logger, sha2)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="http://docs.seattlerb.org/flay/" target="_blank"><b>DuplicateCode</b></a>        </span>      </div>      <span>Similar code found in 3 nodes</span>              <span>Locations:</span>                  <a href="../../bosh-dev/lib/bosh/dev/sandbox/http_endpoint_connector.html#L9" class="js-smell-location">0</a>                  <a href="../../bosh-template/lib/bosh/template/evaluation_link_instance.html#L16" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L7" class="js-smell-location">2</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Long-Parameter-List.md" target="_blank"><b>LongParameterList</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#initialize has 7 parameters</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Uncommunicative-Parameter-Name.md" target="_blank"><b>UncommunicativeParameterName</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#initialize has the parameter name 'sha2'</span>          </div>  </li></ol>
      @bosh_work_dir = bosh_work_dir
      @bosh_config = bosh_config
      @agent_log_path_resolver = agent_log_path_resolver
      @nats_log_path = nats_log_path
      @saved_logs_path = saved_logs_path
      @logger = logger
      @sha2 = sha2<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Uncommunicative-Variable-Name.md" target="_blank"><b>UncommunicativeVariableName</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner has the variable name '@sha2'</span>          </div>  </li></ol>
    end

    def run(cmd, options = {})
      run_in_dir(cmd, @bosh_work_dir, options)
    end

    def run_interactively(cmd, options = {})<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#run_interactively has approx 7 statements</span>          </div>  </li></ol>
      Dir.chdir(@bosh_work_dir) do
        options[:tty] = true
        options[:interactive] = true
        command = generate_command(cmd, options)
        @logger.info(&quot;Running ... `#{command}`&quot;)

        BlueShell::Runner.run({}, &quot;#{command}&quot;) do |runner|
          yield runner
        end
      end
    end

    def reset
      FileUtils.rm_rf(@bosh_config)
    end

    def current_sandbox
      sandbox = Thread.current[:sandbox]
      raise &quot;call prepare_sandbox to set up this thread&#39;s sandbox&quot; if sandbox.nil?<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Nil-Check.md" target="_blank"><b>NilCheck</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#current_sandbox performs a nil-check</span>          </div>  </li></ol>
      sandbox
    end

    def run_in_current_dir(cmd, options={})
      run_in_dir(cmd, Dir.pwd, options)
    end

    def run_in_dir(cmd, working_dir, options = {})<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="http://docs.seattlerb.org/flog/" target="_blank"><b>HighComplexity</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#run_in_dir has a flog score of 47</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#run_in_dir has approx 27 statements</span>          </div>  </li></ol>
      failure_expected = options.fetch(:failure_expected, false)
      command = generate_command(cmd, options)
      @logger.info(&quot;Running ... `#{command}`&quot;)
      output    = nil
      env = options.fetch(:env, {})
      exit_code = 0

      time = Benchmark.realtime do
        Open3.popen2e(env, command, chdir: working_dir) do |stdin, stdout_and_stderr, wait_thr|
          if options.fetch(:no_track, false)
            line = &quot;negative-ghostrider&quot;
            start = Time.now<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#run_in_dir calls 'Time.now' 2 times</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L60" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L64" class="js-smell-location">1</a>                  </div>  </li></ol>
            loop do
              line = stdout_and_stderr.gets
              break if line =~ /Task (\d+)/
              raise &#39;Failed to parse task id from output within timeout&#39; if (Time.now - start) &gt; 20<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#run_in_dir calls 'Time.now' 2 times</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L60" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L64" class="js-smell-location">1</a>                  </div>  </li></ol>
            end
            output = line
            exit_code = 0
            begin
              Process.kill(&#39;INT&#39;, wait_thr.pid)
            rescue
              @logger.info(&quot;Failed to kill the cli in a :no-track scenario&quot;)
            end
          else
            output = stdout_and_stderr.read
            exit_code = wait_thr.value.exitstatus
          end
        end
      end

      @logger.info &quot;Exit code is #{exit_code}&quot;

      @logger.info(&quot;Command took #{time} seconds&quot;)

      if exit_code != 0 &amp;&amp; !failure_expected
        if output =~ /bosh task (\d+) --debug/ || output =~ /Task (\d+) error/
          print_task_debug_logs($1, options)
        end

        if output =~ /Timed out pinging to ([a-z\-\d]+) after \d+ seconds/
          print_agent_debug_logs($1)
        end

        raise &quot;ERROR: #{command} failed with output:\n#{output}&quot;
      end

      options.fetch(:return_exit_code, false) ? [output, exit_code] : output
    end

    def print_agent_debug_logs(agent_id)
      agent_output = File.read(@agent_log_path_resolver.call(agent_id)) rescue nil
      output_debug_log(&quot;Agent log #{agent_id}&quot;, agent_output)
      output_debug_log(&quot;Nats log #{agent_id}&quot;, File.read(@nats_log_path)) if File.exists?(@nats_log_path)
    end

    def print_task_debug_logs(task_id, options)
      task_output = run(&quot;task #{task_id} --debug&quot;, options.merge(failure_expected: true, return_exit_code: false))
      output_debug_log(&quot;Director task #{task_id}&quot;, task_output) rescue nil
    end

    def run_until_succeeds(cmd, options = {})<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#run_until_succeeds has approx 7 statements</span>          </div>  </li></ol>
      number_of_retries = options.fetch(:number_of_retries, 10)

      output = &#39;&#39;
      number_of_retries.times do
        output, exit_code = run(cmd, options.merge(failure_expected: true, return_exit_code: true))
        break if exit_code.zero?
        sleep(0.5)
      end

      output
    end

    def get_most_recent_task_id
      task_table = table(run(&#39;tasks --recent --all --json&#39;))

      if task_table.empty?
        raise &#39;No tasks found!&#39;
      end

      task_table[0][&#39;id&#39;]
    end

    private

    def generate_command(cmd, options)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="http://docs.seattlerb.org/flog/" target="_blank"><b>HighComplexity</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command has a flog score of 42</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command has approx 23 statements</span>          </div>  </li></ol>
      no_color = options.fetch(:no_color, false)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      log_in = options.fetch(:include_credentials, true)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      client = options[:client] || &#39;test&#39;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      client_secret = options[:client_secret] || &#39;test&#39;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      config = options.fetch(:config, @bosh_config)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      cli_options = &#39;&#39;
      cli_options += options.fetch(:tty, true) ? &#39; --tty&#39; : &#39;&#39;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      cli_options += &quot; --client=#{client} --client-secret=#{client_secret}&quot; if log_in
      cli_options += options.fetch(:interactive, false) ? &#39;&#39; : &#39; -n&#39;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      cli_options += &quot; --no-color&quot; if no_color
      cli_options += &quot; -e #{options[:environment_name] || current_sandbox.director_url}&quot;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      cli_options += &quot; -d #{options[:deployment_name]}&quot; if options[:deployment_name]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command calls 'options[:deployment_name]' 2 times</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      cli_options += &quot; --config #{config}&quot;

      default_ca_cert = Bosh::Dev::Sandbox::Workspace.new.asset_path(&quot;ca/certs/rootCA.pem&quot;)
      cli_options += options.fetch(:ca_cert, nil) ? &quot; --ca-cert #{options[:ca_cert]}&quot; : &quot; --ca-cert #{default_ca_cert}&quot;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      cli_options += options.fetch(:json, false) ? &#39; --json&#39; : &#39;&#39;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Feature-Envy.md" target="_blank"><b>FeatureEnvy</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#generate_command refers to 'options' more than self (maybe move it to another class?)</span>              <span>Locations:</span>                  <a href="bosh_go_cli_runner.html#L136" class="js-smell-location">0</a>                  <a href="bosh_go_cli_runner.html#L137" class="js-smell-location">1</a>                  <a href="bosh_go_cli_runner.html#L138" class="js-smell-location">2</a>                  <a href="bosh_go_cli_runner.html#L139" class="js-smell-location">3</a>                  <a href="bosh_go_cli_runner.html#L140" class="js-smell-location">4</a>                  <a href="bosh_go_cli_runner.html#L142" class="js-smell-location">5</a>                  <a href="bosh_go_cli_runner.html#L144" class="js-smell-location">6</a>                  <a href="bosh_go_cli_runner.html#L146" class="js-smell-location">7</a>                  <a href="bosh_go_cli_runner.html#L147" class="js-smell-location">8</a>                  <a href="bosh_go_cli_runner.html#L151" class="js-smell-location">9</a>                  <a href="bosh_go_cli_runner.html#L152" class="js-smell-location">10</a>                  </div>  </li></ol>
      cli_options += &#39; --sha2&#39; if @sha2

      bosh_cli = ENV[&#39;BOSH_CLI&#39;] || &quot;bosh&quot;
      &quot;#{bosh_cli} #{cli_options} #{cmd}&quot;
    end

    DEBUG_HEADER = &#39;*&#39; * 20

    def output_debug_log(title, output)
      content = &lt;&lt;-EOF
        #{DEBUG_HEADER} start #{title} #{DEBUG_HEADER}
        #{output}
        #{DEBUG_HEADER} end #{title} #{DEBUG_HEADER}
      EOF

      FileUtils.mkdir_p(File.dirname(@saved_logs_path))
      File.open(@saved_logs_path, &#39;a&#39;) { |f| f.write(content) }<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Uncommunicative-Variable-Name.md" target="_blank"><b>UncommunicativeVariableName</b></a>        </span>      </div>      <span>Bosh::Spec::BoshGoCliRunner#output_debug_log has the variable name 'f'</span>          </div>  </li></ol>

      @logger.info(content)
    end
  end
end
</code>
  </div>
</div>

        </div>
      </div>
    </div>

    <!-- Javascripts -->
    <script src='../../assets/javascripts/jquery.min.js'></script>
    <script src='../../assets/javascripts/jquery.tablesorter.min.js'></script>
    <script src='../../assets/javascripts/jquery.scrollTo.min.js'></script>
    <script src='../../assets/javascripts/jquery.timeago.js'></script>
    <script src='../../assets/javascripts/highcharts.src-4.0.1.js'></script>
    <script src='../../assets/javascripts/prettify.js'></script>
    <script src='../../assets/javascripts/bootstrap.min.js'></script>
    <script src='../../assets/javascripts/application.js'></script>
    <script src='../../assets/javascripts/jquery.filtertable.min.js'></script>
  </body>
</html>
